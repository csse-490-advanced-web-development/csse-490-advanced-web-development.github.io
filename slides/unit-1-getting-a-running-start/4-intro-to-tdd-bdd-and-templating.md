# CSSE-490: Advanced Web Development
### Week 3: Getting a Running Start

## Intro to Lab 2
## +
## Intro to Testing
## +
## Intro to Templates and Forms


---

### Lab 2 brings in an expanded application structure

<pre style="margin-left: 5em;">
brocker-lab-2/
├─ app/
│  ├─ controllers/
│  │  ├─ application_controller.rb
│  │  ├─ simple_photo_processor_controller.rb
│  ├─ views/
│  │  ├─ index.html.erb
│  │  ├─ layout.erb
│  │  ├─ simple_photo_processor/
│  │     ├─ new.html.erb
│  ├─ public/
│  │  ├─ images/
│  │  ├─ stylesheets/
├─ spec/
│  ├─ features/
│  │  ├─ homepage_spec.rb
│  │  ├─ simple_photo_processor_spec.rb
      ^---- Tests!!!! We have tests!
</pre>


<br>
<br>

## ..and Tests!

---
layout: two-cols
---

## Eliza's Testing Philosophy

* Test-first, never test-last
  * The only exception is throw-away spike code
  * But only if you actually throw it away!
* Top down testing
* Each layer should be a little more thorough than the last

## As applied to [Lab 2](https://github.com/elizabrock/CSSE-490/blob/main/labs/lab-01-photo-processing-app.md):

* Your mission is to set up the Lab
* Run the tests
* And only implement what the tests tell you is necessary

(If you want to add more functionality, by all means do so, but you must also add tests to go with it!)

::right::

<a href='//sketchviz.com/@elizabrock/91fc6bc5e473e4067fd94261683bfe0b'><img src='https://sketchviz.com/@elizabrock/91fc6bc5e473e4067fd94261683bfe0b/d543ef6880bc12b36a83afe6b85a42301c2fccae.sketchy.png' style='max-width: 100%; max-height: 28em;'></a>
---

Suggested chapters of the book for Lab 1:

* Ch 3. Templates
* Ch 4. Web Forms
* Ch 7. Large Application Structure
* Ch 15. Testing

---

## Intro to Templates
### Jinja

Jinja has all the normal templating things- variables, control structures, etc.

The [Jinja Docs](https://jinja.palletsprojects.com/en/3.0.x/) are extensive.

### General File Structure:
<br>
<pre style="margin-left: 1em;">
brocker-lab-1/
├─ simple_photo_processor.py
├─ static/
│  ├─ css/
│     ├─ main.css
│  ├─ images/
│     ├─ favicon.png
│  ├─ js/
│     ├─ main.js
├─ templates/
│  ├─ index.html
│  ├─ upload.html
</pre>


---
layout: two-cols
---

## Intro to Templates

### Example with variables, layouts, etc

`hello.py`:
```
from flask import Flask, render_template
...
@app.route('/')
def index():
    return render_template('index.html',
    name="Eliza")

@app.route('/simple_photo_processor')
def upload():
    return render_template('upload.html')

```

`templates/index.html`:
```
{% extends 'layout.html' %}

{% block content %}
<p>
  Would you like to try the
  <a href="{{ url_for('upload') }}">Simple Photo Processor</a>
  I've been working on?
</p>
{% endblock %}

```

::right::

<br>
<br>
<br>

`templates/layout.html`:
```
<!doctype html>
<html lang="en">

<head>
  ...
  <title>Simple Photo Processor</title>
  ...
</head>

<body>
  <div class="container">
    {% block content %}
    {% endblock %}
  </div>
</body>

</html>
```

---

## FYI on styling

I'm using [Primitive UI](https://taniarascia.github.io/primitive/) in the labs.

---

## Review of HTML Forms

You may have only see forms briefly in 280.

You should read this: https://developer.mozilla.org/en-US/docs/Learn/Forms/Sending_and_retrieving_form_data


## CSRF == Cross-Site Request Forgery
<br>


> **CSRF Defenses Strategies**
>
> Now you should have a better understanding of how a CSRF attack happens. Let's take a look at how you can prevent them in your applications. Basically, you have two strategies:
>
> 1. Making sure that the request you're receiving is valid, i.e., it comes from a form generated by the server.
> 2. Making sure that the request comes from a legitimate client.
>
> -- Source: [Auth0 Blog: Prevent Cross-Site Request Forgery (CSRF) Attacks](https://auth0.com/blog/cross-site-request-forgery-csrf/)

---

## Let's talk projects


[Project signup sheet](https://docs.google.com/spreadsheets/d/17FoOmJk-xgyoKU9j8y0d_1qRmBEun5ZohD0vRO0hmB8/edit?usp=sharing)
